<div class="chat-window">
  @if (!chat()?.chatItems?.length) {
    <div class="initial-message-wrapper">
      <p class="initial-message">How can I help you today?</p>
    </div>
  }

  @for (chatItem of chat()?.chatItems; track chatItem.id) {
    <div class="chat-message-wrapper">
      <mat-icon class="message-icon">person_outline</mat-icon>
      <p class="chat-message">{{chatItem.userMessageData.text}}</p>
    </div>

    <div class="chat-message-wrapper reversed">
      @switch (chatItem.botMessageData.status) {
        @case (StatusType.Pending) {
          <app-loader/>
        }
        @case (StatusType.Failed) {
          <mat-icon class="message-icon--error">report_problem</mat-icon>
          <p class="chat-message--response">Something went wrong while fetching chat response...</p>
          <app-button label="Try again" (click) = "refreshButtonClick.emit({chatItemId: chatItem.id, userQuery: chatItem.userMessageData.text})">
            <mat-icon icon>rotate_right</mat-icon>
          </app-button>
        }
        @case (StatusType.Success) {
          <mat-icon class="message-icon">android</mat-icon>
          <p class="chat-message--response">{{chatItem.botMessageData.text}}</p>
        }
      }
    </div>
  }
</div>
